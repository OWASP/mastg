# original source: https://github.com/MobSF/mobsfscan/blob/main/mobsfscan/rules/semgrep/crypto/weak_key_size.yaml
rules:
  - id: weak_key_size
    patterns:
      - pattern-either:
          - pattern: |
              $K = $G.getInstance("RSA");
              ...
              $K.initialize(1024, new SecureRandom());
          - pattern: |
              $K = $G.getInstance("RSA");
              ...
              $K.initialize(512, new SecureRandom());
          - pattern: |
              $K = $G.getInstance("AES");
              ...
              $K.init(128);
    message: "Cryptographic implementations with insufficient key length are being used."
    languages:
      - java
    severity: WARNING
    metadata:
      cwe: cwe-326