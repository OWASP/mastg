---
title: Static Analysis on iOS
platform: ios
---

The preferred method of statically analyzing iOS apps involves using the original Xcode project files. Ideally, you will be able to compile and debug the app to quickly identify any potential issues with the source code.

Black box analysis of iOS apps without access to the original source code requires reverse engineering. For example, no decompilers are available for iOS apps (although most commercial and open-source disassemblers can provide a pseudo-source code view of the binary), so a deep inspection requires you to read assembly code.

## Using @MASTG-TOOL-0073

Radare2 (r2) is a powerful reverse engineering framework that provides a wide range of tools for analyzing binaries. This section explains how to use r2 effectively for static analysis, focusing on identifying and analyzing relevant functions in iOS applications.

For interactive analysis, you can also use radare2's [visual mode](https://book.rada.re/visual/visual_disassembly.html) by pressing `V` after opening a binary, which provides a more graphical interface for navigation and analysis.

### Identifying Relevant Functions

**Listing Functions**:

Use the `afl` command to [list all functions](https://book.rada.re/analysis/code_analysis.html#analyze-functions) in the binary and combine the [`~` operator](https://book.rada.re/first_steps/syntax.html#filtering) to filter functions by name. For example, if you're interested in cryptographic functions, you can search using a filter like `afl~SecKey` to find all functions related to `SecKey`. If you already know the function name, you can use `afl~<function_name>` to directly filter for that specific function.

```bash
afl~SecKeyCreateRandomKey
```

Example: In @MASTG-DEMO-0011, `SecKeyCreateRandomKey` is identified as a function of interest.

**When Not to Use `afl`**:

In some cases, functions may not appear in the list generated by `afl`. For example, `canEvaluatePolicy` is a dynamically resolved function and may not be listed.

```bash
afl~canEvaluatePolicy
< no results >
```

Instead, use [flags](https://book.rada.re/commandline/flags.html) (`f`), string searches with `/`, `/z`, `iz~` and then use [cross-references](#analyzing-cross-references) (`axt`) to locate its usage in the binary. This approach ensures that dynamically resolved or obfuscated functions are not overlooked.

```bash
f~canEvaluatePolicy
0x100008360 24 str.canEvaluatePolicy:error:
```

In the output, you can see a flag `str.canEvaluatePolicy:error:` representing the string `canEvaluatePolicy:error:` which is located at `0x100008360`. You can then use the [`axt` command](https://book.rada.re/analysis/code_analysis.html#analyze-xrefs) to find cross-references to this string using its address:

```bash
axt @ 0x100008360

(nofunc) 0x100000350 [UNKNOWN] invalid
sym.func.100004ea8 0x100004f10 [STRING] ldr x1, [x8, 0xa0]
```

The output shows the cross-references to the given address, indicating where the function is used in the binary in two different locations:

- `0x100000350`: This indicates an invalid reference, possibly due to dynamic resolution.
- `sym.func.100004ea8`: This indicates a valid reference to a function located at `0x100004ea8`, which can be further analyzed. The reference to the string will be at `0x100004f10`.

### Identifying Strings

**Listing Strings**:

Use the [`iz` command](https://book.rada.re/tools/rabin2/strings.html) to list all strings in the binary. Combine it with [`~` filtering](https://book.rada.re/first_steps/syntax.html#filtering) to filter for specific strings. For example, to search for a string containing `somestring`:

```console
iz~+somestring
```

Alternatively, you can use `izz`

**Searching for Specific Strings**:

Use the [`/` command](https://book.rada.re/search/basic_searches.html) to search for a string directly in the binary:

```bash
/ somestring
```

Use advanced search options with [`/`](https://book.rada.re/search/intro.html).

### Analyzing Cross-References

**Finding Cross-References**:

Use the [`axt` command](https://book.rada.re/analysis/code_analysis.html#recursive-analysis) to find cross-references to a specific function. This helps understand how and where the function is invoked.

```console
axt @ <function_address>
```

Note: The `@` symbol is used for [seeking to specific addresses](https://book.rada.re/commandline/seeking.html) in radare2.

Example: In @MASTG-DEMO-0011, cross-references to `SecKeyCreateRandomKey` are analyzed to ensure secure key sizes.

### Inspecting the Disassembly

**Inspecting Function Calls**:

Use the [`pdf` command](https://book.rada.re/commandline/print_modes.html) to decompile a function and inspect its implementation. This provides insights into how the function operates.

```bash
pdf @ <function_address>
```

The `@` symbol [seeks to the specified address](https://book.rada.re/commandline/seeking.html) before executing the command.

**Inspecting Specific Instructions**:

Use the [`pd` command](https://book.rada.re/commandline/print_modes.html) to disassemble a specific number of instructions at a given address. For example, to disassemble 5 instructions:

```bash
pd-- 5 @ 0x1000048c4
```

This is particularly useful for examining the immediate context of a function call or instruction.
